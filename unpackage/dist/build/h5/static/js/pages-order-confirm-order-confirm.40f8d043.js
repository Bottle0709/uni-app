(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-order-confirm-order-confirm"],{1311:function(t,i,n){"use strict";n.r(i);var e=n("fb32"),o=n.n(e);for(var r in e)"default"!==r&&function(t){n.d(i,t,(function(){return e[t]}))}(r);i["default"]=o.a},2970:function(t,i,n){"use strict";n.r(i);var e=n("c32b"),o=n("5bd6");for(var r in o)"default"!==r&&function(t){n.d(i,t,(function(){return o[t]}))}(r);var a,s=n("f0c5"),u=Object(s["a"])(o["default"],e["b"],e["c"],!1,null,"59b495de",null,!1,e["a"],a);i["default"]=u.exports},"3d6f":function(t,i,n){"use strict";var e;n.d(i,"b",(function(){return o})),n.d(i,"c",(function(){return r})),n.d(i,"a",(function(){return e}));var o=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("v-uni-view",{staticClass:"d-flex line-h",class:t.priceSize+" "+t.color},[n("v-uni-text",{staticClass:"a-self-start",class:t.unitSize},[t._v("￥")]),t._t("default")],2)},r=[]},"3e3e":function(t,i,n){"use strict";n.r(i);var e=n("3d6f"),o=n("1311");for(var r in o)"default"!==r&&function(t){n.d(i,t,(function(){return o[t]}))}(r);var a,s=n("f0c5"),u=Object(s["a"])(o["default"],e["b"],e["c"],!1,null,"1f77dc6e",null,!1,e["a"],a);i["default"]=u.exports},"4dab":function(t,i,n){"use strict";var e=n("4ea4");n("7db0"),n("a15b"),n("d81d"),n("b680"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=e(n("5530")),r=e(n("5add")),a=e(n("3e3e")),s=n("2f62"),u={components:{uniListItem:r.default,price:a.default},data:function(){return{loading:!1,path:!1,items:[],couponCount:0,coupon:{id:0,type:0,value:0},order_id:0}},computed:(0,o.default)((0,o.default)((0,o.default)({},(0,s.mapState)({list:function(t){return t.cart.list}})),(0,s.mapGetters)(["defaultPath","totalPrice"])),{},{goodsList:function(){var t=this;return this.items.map((function(i){return t.list.find((function(t){return t.id===i}))}))},price:function(){return 0===this.coupon.id?this.totalPrice:0===this.coupon.type?this.totalPrice-this.coupon.value:(this.totalPrice*(this.coupon.value/10)).toFixed(2)}}),onLoad:function(t){var i=this;if(!t.detail)return uni.showToast({title:"请选择要下单的商品",icon:"none"}),uni.navigateBack({delta:1});this.items=JSON.parse(t.detail),this.defaultPath.length&&(this.path=this.defaultPath[0]),uni.$on("choosePath",(function(t){i.path=t})),uni.$on("couponUser",(function(t){i.coupon=t})),this.getCouponCount()},onUnload:function(){uni.$off("choosePath"),uni.$off("couponUser")},onShow:function(){this.order_id>0&&uni.redirectTo({url:"../order-detail/order-detail?id="+this.order_id})},methods:{openPathList:function(){uni.navigateTo({url:"../user-path-list/user-path-list?type=choose"})},openOrderInvoice:function(){uni.navigateTo({url:"../order-invoice/order-invoice"})},openPayMethods:function(){var t=this;if(!this.loading){if(!this.path)return uni.showToast({title:"请选择收货地址",icon:"none"});var i={user_addresses_id:this.path.id,items:this.items.join(",")};this.coupon.id>0&&(i.coupon_user_id=this.coupon.id),this.loading=!0,this.$H.post("/order",i,{token:!0}).then((function(i){t.loading=!1,uni.navigateTo({url:"../pay-methods/pay-methods?detail="+JSON.stringify({id:i.id,price:i.total_price})}),t.order_id=i.id,uni.$emit("updateCart")})).catch((function(i){t.loading=!1,console.log(i),uni.showToast({title:"创建订单失败",icon:"none"})}))}},openCoupon:function(){uni.navigateTo({url:"../order-coupon/order-coupon?detail="+JSON.stringify({price:this.totalPrice})})},getCouponCount:function(){var t=this;this.$H.post("/coupon_count",{price:this.totalPrice},{token:!0}).then((function(i){t.couponCount=i})).catch((function(t){uni.showToast({title:"获取可用优惠券数量失败",icon:"none"})}))}}};i.default=u},"5bd6":function(t,i,n){"use strict";n.r(i);var e=n("4dab"),o=n.n(e);for(var r in e)"default"!==r&&function(t){n.d(i,t,(function(){return e[t]}))}(r);i["default"]=o.a},c32b:function(t,i,n){"use strict";var e;n.d(i,"b",(function(){return o})),n.d(i,"c",(function(){return r})),n.d(i,"a",(function(){return e}));var o=function(){var t=this,i=t.$createElement,n=t._self._c||i;return n("v-uni-view",{staticStyle:{background:"#F5F5F5","min-height":"100%",height:"auto"}},[n("v-uni-view",{staticClass:"main-bg-color text-white d-flex a-center px-3",staticStyle:{height:"250rpx"},attrs:{"hover-class":"main-bg-hover-color"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openPathList.apply(void 0,arguments)}}},[n("v-uni-view",[t.path?[n("v-uni-view",{staticClass:"font-weight font-md d-flex a-center font-lg"},[t._v(t._s(t.path.name)+" "+t._s(t.path.phone)),t.path.isdefault?n("v-uni-view",{staticClass:"border border-white rounded px-1 font ml-2"},[t._v("默认")]):t._e()],1),n("v-uni-view",{staticClass:"font"},[t._v(t._s(t.path.province)+" "+t._s(t.path.city)+" "+t._s(t.path.district)+" "+t._s(t.path.address))])]:[n("v-uni-view",{staticClass:"font-weight font-md d-flex a-center font-lg"},[t._v("请选择收货地址")])]],2),n("v-uni-view",{staticClass:"iconfont icon-you ml-auto"})],1),n("v-uni-view",{staticStyle:{"border-top-left-radius":"25rpx","border-top-right-radius":"25rpx","margin-top":"-25rpx",overflow:"hidden"}},[n("v-uni-view",{staticClass:"bg-white"},[n("uni-list-item",{attrs:{showArrow:!0}},[n("v-uni-view",{staticClass:"d-flex a-center"},t._l(t.goodsList,(function(t,i){return n("v-uni-image",{key:i,staticClass:"rounded mr-2",staticStyle:{width:"100rpx",height:"100rpx"},attrs:{src:t.cover}})})),1),n("v-uni-view",{attrs:{slot:"rightContent"},slot:"rightContent"},[t._v("共"+t._s(t.goodsList.length)+"件")])],1),n("uni-list-item",{attrs:{title:"商品总价",showArrowIcon:!1}},[n("v-uni-view",{attrs:{slot:"rightContent"},slot:"rightContent"},[n("price",{attrs:{color:"text-dark"}},[t._v(t._s(t.totalPrice))])],1)],1),n("uni-list-item",{attrs:{title:"运费",showArrowIcon:!1}},[n("v-uni-view",{attrs:{slot:"rightContent"},slot:"rightContent"},[t._v("包邮")])],1),n("uni-list-item",{attrs:{title:"优惠券"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openCoupon.apply(void 0,arguments)}}},[n("v-uni-view",{class:t.couponCount>0?"main-text-color":"text-light-muted",attrs:{slot:"rightContent"},slot:"rightContent"},[t.coupon.id>0?n("v-uni-text",[t._v(t._s(0===t.coupon.type?"-"+t.coupon.value+"元":t.coupon.value+"折"))]):n("v-uni-text",[t._v(t._s(0===t.couponCount?"无可用":t.couponCount+"张可用"))])],1)],1),n("uni-list-item",{attrs:{showArrowIcon:!1}},[n("v-uni-text",{staticClass:"main-text-color"},[t._v("小计")]),n("v-uni-view",{attrs:{slot:"rightContent"},slot:"rightContent"},[n("price",[t._v(t._s(t.price))])],1)],1),n("divider"),n("uni-list-item",{attrs:{title:"发票",extraWidth:"40%"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openOrderInvoice.apply(void 0,arguments)}}},[n("v-uni-view",{attrs:{slot:"rightContent"},slot:"rightContent"},[t._v("电子发票-个人")])],1)],1)],1),n("v-uni-view",{staticClass:"position-fixed d-flex a-center j-end border bottom-0 left-0 right-0 bg-white p-2 font-md"},[t._v("合计:"),n("v-uni-view",{staticClass:"ml-2"},[n("price",[t._v(t._s(t.price))])],1),n("v-uni-view",{staticClass:"ml-2 px-2 py-1 text-white font-md",class:t.loading?"bg-secondary":"main-bg-color",staticStyle:{"border-radius":"80rpx"},attrs:{"hover-class":"main-bg-hover-color"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openPayMethods.apply(void 0,arguments)}}},[t._v(t._s(t.loading?"加载中":"去支付"))])],1)],1)},r=[]},fb32:function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e={props:{priceSize:{type:String,default:"font-md"},unitSize:{type:String,default:"font-sm"},color:{type:String,default:"main-text-color"}}};i.default=e}}]);